{"ast":null,"code":"import { Permission } from '../../Models/permission.model';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../Services/permission.service\";\nimport * as i2 from \"../../Services/role.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"../../Services/application.service\";\nimport * as i5 from \"../../Services/journalisation.service\";\nimport * as i6 from \"../../Services/action.service\";\nimport * as i7 from \"./../../Services/utilisateur.service\";\nimport * as i8 from \"../../Services/fonction.service\";\nimport * as i9 from \"@angular/common\";\nimport * as i10 from \"@angular/forms\";\nimport * as i11 from \"../Utilisateur/Acces/cell-style.directive\";\nconst _c0 = [\"table2\"];\nconst _c1 = [\"table1\"];\nfunction PermissionComponent_option_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 21);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const app_r4 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", app_r4.nom);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(app_r4.nom);\n  }\n}\nfunction PermissionComponent_option_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 21);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const role_r5 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", role_r5.nom);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\"\", role_r5.nom, \" ( Niveau \", role_r5.niveau, \" )\");\n  }\n}\nconst _c2 = function () {\n  return [\"/Permission/ModifierPermission\"];\n};\nfunction PermissionComponent_table_28_tr_18_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\")(2, \"i\", 25);\n    i0.ɵɵlistener(\"click\", function PermissionComponent_table_28_tr_18_Template_i_click_2_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r10);\n      const permission_r8 = restoredCtx.$implicit;\n      const ctx_r9 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r9.onModifierClick(permission_r8.id));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"i\", 26);\n    i0.ɵɵlistener(\"click\", function PermissionComponent_table_28_tr_18_Template_i_click_3_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r10);\n      const permission_r8 = restoredCtx.$implicit;\n      const ctx_r11 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r11.deletePermission(permission_r8.id));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\", 27);\n    i0.ɵɵlistener(\"click\", function PermissionComponent_table_28_tr_18_Template_td_click_5_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r10);\n      const permission_r8 = restoredCtx.$implicit;\n      const ctx_r12 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r12.onModifierAccesFonctionMulti(0, permission_r8, $event));\n    });\n    i0.ɵɵelementStart(6, \"span\", 28);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"td\", 29);\n    i0.ɵɵlistener(\"click\", function PermissionComponent_table_28_tr_18_Template_td_click_8_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r10);\n      const permission_r8 = restoredCtx.$implicit;\n      const ctx_r13 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r13.onModifierAccesFonctionMulti(1, permission_r8, $event));\n    });\n    i0.ɵɵelementStart(9, \"span\", 30);\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(11, \"td\", 27);\n    i0.ɵɵlistener(\"click\", function PermissionComponent_table_28_tr_18_Template_td_click_11_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r10);\n      const permission_r8 = restoredCtx.$implicit;\n      const ctx_r14 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r14.onModifierAccesFonctionMulti(2, permission_r8, $event));\n    });\n    i0.ɵɵelementStart(12, \"span\", 28);\n    i0.ɵɵtext(13);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(14, \"td\", 29);\n    i0.ɵɵlistener(\"click\", function PermissionComponent_table_28_tr_18_Template_td_click_14_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r10);\n      const permission_r8 = restoredCtx.$implicit;\n      const ctx_r15 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r15.onModifierAccesFonctionMulti(3, permission_r8, $event));\n    });\n    i0.ɵɵelementStart(15, \"span\", 30);\n    i0.ɵɵtext(16);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(17, \"td\", 27);\n    i0.ɵɵlistener(\"click\", function PermissionComponent_table_28_tr_18_Template_td_click_17_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r10);\n      const permission_r8 = restoredCtx.$implicit;\n      const ctx_r16 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r16.onModifierAccesFonctionMulti(4, permission_r8, $event));\n    });\n    i0.ɵɵelementStart(18, \"span\", 28);\n    i0.ɵɵtext(19);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(20, \"td\", 29);\n    i0.ɵɵlistener(\"click\", function PermissionComponent_table_28_tr_18_Template_td_click_20_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r10);\n      const permission_r8 = restoredCtx.$implicit;\n      const ctx_r17 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r17.onModifierAccesFonctionMulti(5, permission_r8, $event));\n    });\n    i0.ɵɵelementStart(21, \"span\", 30);\n    i0.ɵɵtext(22);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const permission_r8 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(14, _c2));\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", permission_r8.nom, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"appCellStyle\", permission_r8.status[0] === \"0\" ? \"\\u2716\" : \"\\u2714\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(permission_r8.status[0] === \"0\" ? \"\\u2716\" : \"\\u2714\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"appCellStyle\", permission_r8.status[1] === \"0\" ? \"\\u2716\" : \"\\u2714\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(permission_r8.status[1] === \"0\" ? \"\\u2716\" : \"\\u2714\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"appCellStyle\", permission_r8.status[2] === \"0\" ? \"\\u2716\" : \"\\u2714\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(permission_r8.status[2] === \"0\" ? \"\\u2716\" : \"\\u2714\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"appCellStyle\", permission_r8.status[3] === \"0\" ? \"\\u2716\" : \"\\u2714\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(permission_r8.status[3] === \"0\" ? \"\\u2716\" : \"\\u2714\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"appCellStyle\", permission_r8.status[4] === \"0\" ? \"\\u2716\" : \"\\u2714\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(permission_r8.status[4] === \"0\" ? \"\\u2716\" : \"\\u2714\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"appCellStyle\", permission_r8.status[5] === \"0\" ? \"\\u2716\" : \"\\u2714\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(permission_r8.status[5] === \"0\" ? \"\\u2716\" : \"\\u2714\");\n  }\n}\nfunction PermissionComponent_table_28_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"table\", 22, 23)(2, \"thead\")(3, \"tr\");\n    i0.ɵɵelement(4, \"th\");\n    i0.ɵɵelementStart(5, \"th\");\n    i0.ɵɵtext(6, \"LECTURE\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"th\");\n    i0.ɵɵtext(8, \"AJOUT\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"th\");\n    i0.ɵɵtext(10, \"MODIFICATION\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"th\");\n    i0.ɵɵtext(12, \"SUPRESSION\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"th\");\n    i0.ɵɵtext(14, \"IMPRESSION\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"th\");\n    i0.ɵɵtext(16, \"EXPORTATION\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(17, \"tbody\");\n    i0.ɵɵtemplate(18, PermissionComponent_table_28_tr_18_Template, 23, 15, \"tr\", 24);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(18);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.multiPermissions);\n  }\n}\nfunction PermissionComponent_table_48_tr_8_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r22 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\")(2, \"i\", 25);\n    i0.ɵɵlistener(\"click\", function PermissionComponent_table_48_tr_8_Template_i_click_2_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r22);\n      const permission_r20 = restoredCtx.$implicit;\n      const ctx_r21 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r21.onModifierClick(permission_r20.id));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"i\", 26);\n    i0.ɵɵlistener(\"click\", function PermissionComponent_table_48_tr_8_Template_i_click_3_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r22);\n      const permission_r20 = restoredCtx.$implicit;\n      const ctx_r23 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r23.deletePermission(permission_r20.id));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\", 29);\n    i0.ɵɵlistener(\"click\", function PermissionComponent_table_48_tr_8_Template_td_click_5_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r22);\n      const permission_r20 = restoredCtx.$implicit;\n      const ctx_r24 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r24.onModifierAccesFonctionUnique(permission_r20, $event));\n    });\n    i0.ɵɵelementStart(6, \"span\", 30);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const permission_r20 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(4, _c2));\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", permission_r20.nom, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"appCellStyle\", permission_r20.status === \"0\" ? \"\\u2716\" : \"\\u2714\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(permission_r20.status === \"0\" ? \"\\u2716\" : \"\\u2714\");\n  }\n}\nfunction PermissionComponent_table_48_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"table\", 22, 31)(2, \"thead\")(3, \"tr\");\n    i0.ɵɵelement(4, \"th\");\n    i0.ɵɵelementStart(5, \"th\");\n    i0.ɵɵtext(6, \"ACTION\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(7, \"tbody\");\n    i0.ɵɵtemplate(8, PermissionComponent_table_48_tr_8_Template, 8, 5, \"tr\", 24);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(8);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r3.uniquePermissions);\n  }\n}\nconst _c3 = function () {\n  return [\"/Permission/AjouterPermission\"];\n};\nexport class PermissionComponent {\n  constructor(PermissionService, RoleService, route, router, ApplicationService, JournalisationService, ActionService, UtilisateurService, FonctionService) {\n    this.PermissionService = PermissionService;\n    this.RoleService = RoleService;\n    this.route = route;\n    this.router = router;\n    this.ApplicationService = ApplicationService;\n    this.JournalisationService = JournalisationService;\n    this.ActionService = ActionService;\n    this.UtilisateurService = UtilisateurService;\n    this.FonctionService = FonctionService;\n    this.permission = new Permission();\n    this.roles = [];\n    this.applications = [];\n    this.multiPermissions = [];\n    this.uniquePermissions = [];\n    this.rechApp = '';\n    this.rechRole = '';\n    this.rechFonctionMulti = '';\n    this.rechFonctionUnique = '';\n    this.IdApp = 0;\n    this.IdRole = 0;\n    this.i = 0;\n    this.listePermissionsPredefini = [];\n  }\n  ngOnInit() {\n    this.ajouterListePermissionsPredefini();\n    this.ApplicationService.getApplications().subscribe(data => {\n      this.applications = data;\n      if (this.applications && this.applications.length > 0) {\n        this.IdApp = this.applications[0].id;\n        this.rechApp = this.applications[0].nom;\n        this.RoleService.getRoles(this.IdApp).subscribe(data => {\n          this.roles = data;\n          this.IdRole = this.roles[0].id;\n          this.rechRole = this.roles[0].nom;\n          this.loadPermissions();\n        });\n      }\n    }, error => {\n      console.error('Erreur lors de la récupération des applications : ', error);\n    });\n  }\n  loadApplications() {\n    this.ApplicationService.getApplications().subscribe(data => {\n      this.applications = data;\n    }, error => {\n      console.error('Erreur lors de la récupération des applications : ', error);\n    });\n  }\n  getSelectedApplicationId() {\n    const selectedApplication = this.applications.find(app => app.nom === this.rechApp);\n    if (selectedApplication) {\n      this.IdApp = selectedApplication.id;\n      this.RoleService.getRoles(this.IdApp).subscribe(data => {\n        this.roles = data;\n        this.IdRole = this.roles[0].id;\n        this.rechRole = this.roles[0].nom;\n        this.loadPermissions();\n      }, error => {\n        console.error('Erreur lors de la récupération des roles : ', error);\n      });\n      return selectedApplication.id;\n    } else return 0;\n  }\n  getSelectedRoleId() {\n    const selectedRole = this.roles.find(r => r.nom === this.rechRole);\n    if (selectedRole) {\n      this.IdRole = selectedRole.id;\n      this.loadPermissions();\n      return selectedRole.id;\n    } else return 0;\n  }\n  loadPermissions() {\n    if (this.applications.length > 0 && this.roles.length > 0) {\n      this.PermissionService.getListeMultiFonction(this.IdApp, this.IdRole).subscribe(data => {\n        this.multiPermissions = data;\n      }, error => {\n        console.error('Erreur lors de la récupération des Permissions : ', error);\n      });\n      this.PermissionService.getListeFonctionUnique(this.IdApp, this.IdRole).subscribe(data => {\n        this.uniquePermissions = data;\n      }, error => {\n        console.error('Erreur lors de la récupération des Permissions : ', error);\n      });\n    }\n  }\n  RechMultiFonction() {\n    if (this.rechFonctionMulti == \"\") this.loadPermissions();else {\n      this.PermissionService.getListeMultiFonction(this.IdApp, this.IdRole).subscribe(data => {\n        this.multiPermissions = data;\n        this.multiPermissions = this.multiPermissions.filter(perm => {\n          return perm.nom.toLowerCase().includes(this.rechFonctionMulti.toLowerCase());\n        });\n      });\n    }\n  }\n  RechFonctionUnique() {\n    if (this.rechFonctionUnique == \"\") this.loadPermissions();else {\n      this.PermissionService.getListeFonctionUnique(this.IdApp, this.IdRole).subscribe(data => {\n        this.uniquePermissions = data;\n        this.uniquePermissions = this.uniquePermissions.filter(perm => {\n          return perm.nom.toLowerCase().includes(this.rechFonctionUnique.toLowerCase());\n        });\n      });\n    }\n  }\n  onModifierAccesFonctionMulti(index, perm, event) {\n    this.i = index;\n    const target = event.target;\n    const span = target.querySelector('span');\n    if (span?.textContent === '✔') {\n      span.textContent = '✖';\n      target.style.backgroundColor = 'red';\n    } else if (span?.textContent === '✖') {\n      span.textContent = '✔';\n      target.style.backgroundColor = '#128d3a';\n    }\n    this.PermissionService.ModifierAcces(this.IdApp, this.i, perm).subscribe(() => {\n      this.loadPermissions();\n      this.EnregistrerAction(this.IdApp, this.IdRole, \"MultiFonction\", perm);\n    });\n  }\n  onModifierAccesFonctionUnique(perm, event) {\n    const target = event.target;\n    const span = target.querySelector('span');\n    if (span?.textContent === '✔' && perm.status == \"1\") {\n      span.textContent = '✖';\n      target.style.backgroundColor = 'red';\n    } else if (span?.textContent === '✖' && perm.status == \"0\") {\n      span.textContent = '✔';\n      target.style.backgroundColor = '#128d3a';\n    }\n    this.PermissionService.ModifierAcces(this.IdApp, this.i, perm).subscribe(() => {\n      this.loadPermissions();\n      this.EnregistrerAction(this.IdApp, this.IdRole, \"Fonction Unique\", perm);\n    });\n  }\n  onModifierClick(id) {\n    this.router.navigate(['Permission/ModifierPermission', id]);\n  }\n  EnregistrerActionSupp(id) {\n    let username = localStorage.getItem(\"username\");\n    this.UtilisateurService.Recherche(username).subscribe(data => {\n      this.JournalisationService.getJournalisations(data[0].id).subscribe(dataJournalisations => {\n        let idJournalisation = dataJournalisations[dataJournalisations.length - 1].id;\n        const action = {\n          id: 0,\n          application: \"www.wbauth.com\",\n          date: new Date(),\n          description: `l'utilisateur ${username} a supprimer la permission avec l'id '${id}' du role '${this.rechRole}' dans l'application '${this.rechApp}' avec l'id '${this.IdApp}'`,\n          idJournalisation: idJournalisation,\n          journalisation: dataJournalisations[dataJournalisations.length - 1]\n        };\n        this.ActionService.EnregistrementActions(action).subscribe(() => {\n          console.log(action);\n        });\n      });\n    });\n  }\n  deletePermission(id) {\n    if (confirm('Voulez-vous vraiment supprimer ce Permission ?')) {\n      this.PermissionService.deletePermission(id).subscribe(() => {\n        this.loadPermissions();\n        this.EnregistrerActionSupp(id);\n      });\n    }\n  }\n  scrollToTable2() {\n    if (this.table2) {\n      this.table2.nativeElement.scrollIntoView({\n        behavior: 'smooth',\n        block: 'start'\n      });\n    }\n  }\n  scrollToTable1() {\n    if (this.table1) {\n      this.table1.nativeElement.scrollIntoView({\n        behavior: 'smooth',\n        block: 'start'\n      });\n    }\n  }\n  EnregistrerAction(IdApp, IdRole, type, perm) {\n    let username = localStorage.getItem(\"username\");\n    this.UtilisateurService.Recherche(username).subscribe(data => {\n      this.JournalisationService.getJournalisations(data[0].id).subscribe(dataJournalisations => {\n        let idJournalisation = dataJournalisations[dataJournalisations.length - 1].id;\n        if (type === \"MultiFonction\") {\n          const action = {\n            id: 0,\n            application: \"www.wbauth.com\",\n            date: new Date(),\n            description: `l'utilisateur ${username} a modifier la permission '${perm.nom}' du role avec l'id '${IdRole}' de l'application avec l'id '${IdApp}'  `,\n            idJournalisation: idJournalisation,\n            journalisation: dataJournalisations[dataJournalisations.length - 1]\n          };\n          this.ActionService.EnregistrementActions(action).subscribe(() => {\n            console.log(action);\n          });\n        } else if (type === \"Fonction Unique\") {\n          const action = {\n            id: 0,\n            application: \"www.wbauth.com\",\n            date: new Date(),\n            description: `l'utilisateur ${username} a modifier la permission '${perm.nom}' du role avec l'id '${IdRole}' de l'application avec l'id '${IdApp}'  `,\n            idJournalisation: idJournalisation,\n            journalisation: dataJournalisations[dataJournalisations.length - 1]\n          };\n          this.ActionService.EnregistrementActions(action).subscribe(() => {\n            console.log(action);\n          });\n        }\n      });\n    });\n  }\n  ajouterListePermissionsPredefini() {\n    this.ApplicationService.Recherche(\"www.wbauth.com\").subscribe(dataApp => {\n      if (dataApp[0].url == \"www.wbauth.com\") {\n        this.RoleService.getRoles(dataApp[0].id).subscribe(dataRoles => {\n          for (const role of dataRoles) {\n            if (role.nom == \"Utilisateur\" || role.nom == \"utilisateur\") {\n              this.listePermissionsPredefini = [];\n              this.listePermissionsPredefini.push(new Permission(0, 'Gestion des applications', '100000', role.id, role, 0, null), new Permission(0, 'Gestion des fonctions', '100000', role.id, role, 0, null), new Permission(0, 'Gestion des roles', '100000', role.id, role, 0, null), new Permission(0, 'Gestion des permissions', '100000', role.id, role, 0, null), new Permission(0, 'Gestion des utilisateurs', '100000', role.id, role, 0, null), new Permission(0, 'Consulter la liste des accès utilisateurs', '0', role.id, role, 0, null), new Permission(0, 'Modifier la liste des accès d\\'un utilisateur', '0', role.id, role, 0, null), new Permission(0, 'Consulter la journalisation d\\'un utilisateur', '0', role.id, role, 0, null), new Permission(0, 'Modifier son compte utilisateur', '1', role.id, role, 0, null));\n              for (const perm of this.listePermissionsPredefini) {\n                if (perm.status.length > 2) {\n                  this.PermissionService.RechMultiFonction(perm.nom, dataApp[0].id, role.id).subscribe(dataPermission => {\n                    console.log(dataPermission);\n                    if (dataPermission && dataPermission.length < 1) {\n                      this.FonctionService.Recherche(perm.nom, dataApp[0].id).subscribe(dataFonction => {\n                        perm.idFonction = dataFonction[0].id;\n                        perm.Fonction = dataFonction[0];\n                        this.PermissionService.addPermission(perm).subscribe(() => {});\n                      });\n                    }\n                  });\n                } else if (perm.status.length < 2) {\n                  this.PermissionService.RechFonctionUnique(perm.nom, dataApp[0].id, role.id).subscribe(dataPermission => {\n                    if (dataPermission && dataPermission.length < 1) {\n                      this.FonctionService.Recherche(perm.nom, dataApp[0].id).subscribe(dataFonction => {\n                        perm.idFonction = dataFonction[0].id;\n                        perm.Fonction = dataFonction[0];\n                        this.PermissionService.addPermission(perm).subscribe(() => {});\n                      });\n                    }\n                  });\n                }\n              }\n            } else if (role.nom == \"Administrateur\" || role.nom == \"administrateur\") {\n              this.listePermissionsPredefini.push(new Permission(0, 'Gestion des applications', '100000', role.id, role, 0, null), new Permission(0, 'Gestion des fonctions', '100011', role.id, role, 0, null), new Permission(0, 'Gestion des roles', '100011', role.id, role, 0, null), new Permission(0, 'Gestion des permissions', '100011', role.id, role, 0, null), new Permission(0, 'Gestion des utilisateurs', '111111', role.id, role, 0, null), new Permission(0, 'Consulter la liste des accès utilisateurs', '1', role.id, role, 0, null), new Permission(0, 'Modifier la liste des accès d\\'un utilisateur', '1', role.id, role, 0, null), new Permission(0, 'Consulter la journalisation d\\'un utilisateur', '1', role.id, role, 0, null), new Permission(0, 'Modifier son compte utilisateur', '1', role.id, role, 0, null));\n              for (const perm of this.listePermissionsPredefini) {\n                if (perm.status.length > 2) {\n                  this.PermissionService.RechMultiFonction(perm.nom, dataApp[0].id, role.id).subscribe(dataPermission => {\n                    console.log(dataPermission);\n                    if (dataPermission && dataPermission.length < 1) {\n                      this.FonctionService.Recherche(perm.nom, dataApp[0].id).subscribe(dataFonction => {\n                        perm.idFonction = dataFonction[0].id;\n                        perm.Fonction = dataFonction[0];\n                        this.PermissionService.addPermission(perm).subscribe(() => {});\n                      });\n                    }\n                  });\n                } else if (perm.status.length < 2) {\n                  this.PermissionService.RechFonctionUnique(perm.nom, dataApp[0].id, role.id).subscribe(dataPermission => {\n                    if (dataPermission && dataPermission.length < 1) {\n                      this.FonctionService.Recherche(perm.nom, dataApp[0].id).subscribe(dataFonction => {\n                        perm.idFonction = dataFonction[0].id;\n                        perm.Fonction = dataFonction[0];\n                        this.PermissionService.addPermission(perm).subscribe(() => {});\n                      });\n                    }\n                  });\n                }\n              }\n            } else if (role.nom == \"Super-Administrateur\" || role.nom == \"Super-administrateur\" || role.nom == \"super-administrateur\" || role.nom == \"Super Administrateur\" || role.nom == \"Super administrateur\" || role.nom == \"super administrateur\") {\n              this.listePermissionsPredefini.push(new Permission(0, 'Gestion des applications', '111111', role.id, role, 0, null), new Permission(0, 'Gestion des fonctions', '111111', role.id, role, 0, null), new Permission(0, 'Gestion des roles', '111111', role.id, role, 0, null), new Permission(0, 'Gestion des permissions', '111111', role.id, role, 0, null), new Permission(0, 'Gestion des utilisateurs', '111111', role.id, role, 0, null), new Permission(0, 'Consulter la liste des accès utilisateurs', '1', role.id, role, 0, null), new Permission(0, 'Modifier la liste des accès d\\'un utilisateur', '1', role.id, role, 0, null), new Permission(0, 'Consulter la journalisation d\\'un utilisateur', '1', role.id, role, 0, null), new Permission(0, 'Modifier son compte utilisateur', '1', role.id, role, 0, null));\n              for (const perm of this.listePermissionsPredefini) {\n                if (perm.status.length > 2) {\n                  this.PermissionService.RechMultiFonction(perm.nom, dataApp[0].id, role.id).subscribe(dataPermission => {\n                    console.log(dataPermission);\n                    if (dataPermission && dataPermission.length < 1) {\n                      this.FonctionService.Recherche(perm.nom, dataApp[0].id).subscribe(dataFonction => {\n                        perm.idFonction = dataFonction[0].id;\n                        perm.Fonction = dataFonction[0];\n                        this.PermissionService.addPermission(perm).subscribe(() => {});\n                      });\n                    }\n                  });\n                } else if (perm.status.length < 2) {\n                  this.PermissionService.RechFonctionUnique(perm.nom, dataApp[0].id, role.id).subscribe(dataPermission => {\n                    if (dataPermission && dataPermission.length < 1) {\n                      this.FonctionService.Recherche(perm.nom, dataApp[0].id).subscribe(dataFonction => {\n                        perm.idFonction = dataFonction[0].id;\n                        perm.Fonction = dataFonction[0];\n                        this.PermissionService.addPermission(perm).subscribe(() => {});\n                      });\n                    }\n                  });\n                }\n              }\n            }\n          }\n        });\n      }\n    });\n  }\n  static #_ = this.ɵfac = function PermissionComponent_Factory(t) {\n    return new (t || PermissionComponent)(i0.ɵɵdirectiveInject(i1.PermissionService), i0.ɵɵdirectiveInject(i2.RoleService), i0.ɵɵdirectiveInject(i3.ActivatedRoute), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i4.ApplicationService), i0.ɵɵdirectiveInject(i5.JournalisationService), i0.ɵɵdirectiveInject(i6.ActionService), i0.ɵɵdirectiveInject(i7.UtilisateurService), i0.ɵɵdirectiveInject(i8.FonctionService));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: PermissionComponent,\n    selectors: [[\"app-Permission\"]],\n    viewQuery: function PermissionComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5);\n        i0.ɵɵviewQuery(_c1, 5);\n      }\n      if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.table2 = _t.first);\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.table1 = _t.first);\n      }\n    },\n    decls: 49,\n    vars: 12,\n    consts: [[1, \"background-titre\"], [1, \"centered-element\"], [1, \"content\"], [1, \"search-bar-and-add\"], [1, \"add-button\", 3, \"routerLink\"], [1, \"fas\", \"fa-plus\", 2, \"color\", \"#1ddd92\"], [\"type\", \"text\", \"placeholder\", \"Rechercher...\", 1, \"search-input\", 3, \"ngModel\", \"ngModelChange\", \"input\"], [\"type\", \"submit\", 1, \"search-button\"], [1, \"fas\", \"fa-search\"], [1, \"choix-application\"], [\"for\", \"nom\", 2, \"transform\", \"translateX(-3px)\"], [\"id\", \"IdApp\", \"name\", \"IdApp\", 3, \"ngModel\", \"ngModelChange\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"id\", \"IdRole\", \"name\", \"IdRole\", 3, \"ngModel\", \"ngModelChange\"], [2, \"white-space\", \"nowrap\", \"border\", \"1.5px solid #349AB5\", \"border-radius\", \"4px\", \"padding\", \"4px\", \"font-weight\", \"600\", \"display\", \"flex\", \"align-items\", \"center\"], [1, \"add-button\", 2, \"padding\", \"8.5px\", 3, \"click\"], [1, \"fa-solid\", \"fa-angles-down\", 2, \"color\", \"gold\"], [2, \"margin\", \"auto\"], [\"aria-labelledby\", \"tableLabel\", 4, \"ngIf\"], [2, \"color\", \"aqua\"], [1, \"fa-solid\", \"fa-angles-up\", 2, \"color\", \"gold\"], [3, \"value\"], [\"aria-labelledby\", \"tableLabel\"], [\"table1\", \"\"], [4, \"ngFor\", \"ngForOf\"], [1, \"far\", \"fa-edit\", 2, \"color\", \"#e6c347\", 3, \"routerLink\", \"click\"], [1, \"far\", \"fa-trash-alt\", 2, \"color\", \"red\", \"margin\", \"0px 7px 0px 7px\", 3, \"click\"], [2, \"display\", \"flex\", \"justify-content\", \"center\", \"cursor\", \"pointer\", 3, \"click\"], [1, \"no-select\", 3, \"appCellStyle\"], [2, \"position\", \"relative\", \"cursor\", \"pointer\", 3, \"click\"], [1, \"no-select\", 2, \"position\", \"relative\", \"left\", \"45%\", 3, \"appCellStyle\"], [\"table2\", \"\"]],\n    template: function PermissionComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"h1\");\n        i0.ɵɵtext(2, \" GESTION DES PERMISSIONS \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(3, \"div\", 1)(4, \"div\", 2)(5, \"div\", 3)(6, \"button\", 4);\n        i0.ɵɵelement(7, \"i\", 5);\n        i0.ɵɵtext(8, \" \\u00A0 AJOUTER \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(9, \"input\", 6);\n        i0.ɵɵlistener(\"ngModelChange\", function PermissionComponent_Template_input_ngModelChange_9_listener($event) {\n          return ctx.rechFonctionMulti = $event;\n        })(\"input\", function PermissionComponent_Template_input_input_9_listener() {\n          return ctx.RechMultiFonction();\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"button\", 7);\n        i0.ɵɵelement(11, \"i\", 8);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(12, \"br\");\n        i0.ɵɵelementStart(13, \"div\", 9)(14, \"label\", 10);\n        i0.ɵɵtext(15, \"APPLICATION :\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"select\", 11);\n        i0.ɵɵlistener(\"ngModelChange\", function PermissionComponent_Template_select_ngModelChange_16_listener($event) {\n          return ctx.rechApp = $event;\n        })(\"ngModelChange\", function PermissionComponent_Template_select_ngModelChange_16_listener() {\n          return ctx.getSelectedApplicationId();\n        });\n        i0.ɵɵtemplate(17, PermissionComponent_option_17_Template, 2, 2, \"option\", 12);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"label\", 10);\n        i0.ɵɵtext(19, \"R\\u00D4LE :\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(20, \"select\", 13);\n        i0.ɵɵlistener(\"ngModelChange\", function PermissionComponent_Template_select_ngModelChange_20_listener($event) {\n          return ctx.rechRole = $event;\n        })(\"ngModelChange\", function PermissionComponent_Template_select_ngModelChange_20_listener() {\n          return ctx.getSelectedRoleId();\n        });\n        i0.ɵɵtemplate(21, PermissionComponent_option_21_Template, 2, 3, \"option\", 12);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(22, \"div\", 14)(23, \"button\", 15);\n        i0.ɵɵlistener(\"click\", function PermissionComponent_Template_button_click_23_listener() {\n          return ctx.scrollToTable2();\n        });\n        i0.ɵɵelement(24, \"i\", 16);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(25, \"div\", 17);\n        i0.ɵɵtext(26, \" TABLEAU MULTI-FONCTIONS \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(27, \"br\");\n        i0.ɵɵtemplate(28, PermissionComponent_table_28_Template, 19, 1, \"table\", 18);\n        i0.ɵɵelement(29, \"br\")(30, \"br\")(31, \"br\")(32, \"br\")(33, \"hr\", 19);\n        i0.ɵɵelementStart(34, \"div\", 3)(35, \"button\", 4);\n        i0.ɵɵelement(36, \"i\", 5);\n        i0.ɵɵtext(37, \" \\u00A0 AJOUTER \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(38, \"input\", 6);\n        i0.ɵɵlistener(\"ngModelChange\", function PermissionComponent_Template_input_ngModelChange_38_listener($event) {\n          return ctx.rechFonctionUnique = $event;\n        })(\"input\", function PermissionComponent_Template_input_input_38_listener() {\n          return ctx.RechFonctionUnique();\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(39, \"button\", 7);\n        i0.ɵɵelement(40, \"i\", 8);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(41, \"br\");\n        i0.ɵɵelementStart(42, \"div\", 14)(43, \"button\", 15);\n        i0.ɵɵlistener(\"click\", function PermissionComponent_Template_button_click_43_listener() {\n          return ctx.scrollToTable1();\n        });\n        i0.ɵɵelement(44, \"i\", 20);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(45, \"div\", 17);\n        i0.ɵɵtext(46, \" TABLEAU DE FONCTION UNIQUE \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(47, \"br\");\n        i0.ɵɵtemplate(48, PermissionComponent_table_48_Template, 9, 1, \"table\", 18);\n        i0.ɵɵelementEnd()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(10, _c3));\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngModel\", ctx.rechFonctionMulti);\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"ngModel\", ctx.rechApp);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.applications);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngModel\", ctx.rechRole);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.roles);\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"ngIf\", ctx.multiPermissions);\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(11, _c3));\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngModel\", ctx.rechFonctionUnique);\n        i0.ɵɵadvance(10);\n        i0.ɵɵproperty(\"ngIf\", ctx.uniquePermissions);\n      }\n    },\n    dependencies: [i9.NgForOf, i9.NgIf, i10.NgSelectOption, i10.ɵNgSelectMultipleOption, i10.DefaultValueAccessor, i10.SelectControlValueAccessor, i10.NgControlStatus, i10.NgModel, i3.RouterLink, i11.CellStyleDirective],\n    encapsulation: 2\n  });\n}","map":{"version":3,"mappings":"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","names":["Permission","i0","PermissionComponent","constructor","PermissionService","RoleService","route","router","ApplicationService","JournalisationService","ActionService","UtilisateurService","FonctionService","ngOnInit","ajouterListePermissionsPredefini","getApplications","subscribe","data","applications","length","IdApp","id","rechApp","nom","getRoles","roles","IdRole","rechRole","loadPermissions","error","console","loadApplications","getSelectedApplicationId","selectedApplication","find","app","getSelectedRoleId","selectedRole","r","getListeMultiFonction","multiPermissions","getListeFonctionUnique","uniquePermissions","RechMultiFonction","rechFonctionMulti","filter","perm","toLowerCase","includes","RechFonctionUnique","rechFonctionUnique","onModifierAccesFonctionMulti","index","event","i","target","span","querySelector","textContent","style","backgroundColor","ModifierAcces","EnregistrerAction","onModifierAccesFonctionUnique","status","onModifierClick","navigate","EnregistrerActionSupp","username","localStorage","getItem","Recherche","getJournalisations","dataJournalisations","idJournalisation","action","application","date","Date","description","journalisation","EnregistrementActions","log","deletePermission","confirm","scrollToTable2","table2","nativeElement","scrollIntoView","behavior","block","scrollToTable1","table1","type","dataApp","url","dataRoles","role","listePermissionsPredefini","push","dataPermission","dataFonction","idFonction","Fonction","addPermission","selectors","viewQuery","ctx"],"sourceRoot":"","sources":["C:\\Users\\Skander\\source\\repos\\WBAuth.Frontend\\ClientApp\\src\\app\\Modules\\Permission\\Permission.component.ts","C:\\Users\\Skander\\source\\repos\\WBAuth.Frontend\\ClientApp\\src\\app\\Modules\\Permission\\Permission.component.html"],"sourcesContent":["import { Component, Inject, ElementRef, ViewChild } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Role } from '../../Models/role.model';\r\nimport { RoleService } from '../../Services/role.service';\r\nimport { Application } from '../../Models/application.model';\r\nimport { ApplicationService } from '../../Services/application.service';\r\nimport { Permission } from '../../Models/permission.model';\r\nimport { PermissionService } from '../../Services/permission.service';\r\nimport { filter, Observable } from 'rxjs';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { JournalisationService } from '../../Services/journalisation.service';\r\nimport { UtilisateurService } from './../../Services/utilisateur.service';\r\nimport { ActionService } from '../../Services/action.service';\r\nimport { Action } from '../../Models/action.model';\r\nimport { FonctionService } from '../../Services/fonction.service';\r\nimport { Fonction } from '../../Models/fonction.model';\r\n\r\n\r\n@Component({\r\n  selector: 'app-Permission',\r\n  templateUrl: './Permission.component.html'\r\n})\r\nexport class PermissionComponent {\r\n  @ViewChild('table2', { static: false }) table2: ElementRef | undefined;\r\n  @ViewChild('table1', { static: false }) table1: ElementRef | undefined;\r\n  permission: Permission = new Permission();\r\n  roles: any[] = [];\r\n  applications: any[] = [];\r\n  multiPermissions: any[] = [];\r\n  uniquePermissions: any[] = [];\r\n  rechApp: string = '';\r\n  rechRole: string = '';\r\n  rechFonctionMulti: string = '';\r\n  rechFonctionUnique: string = '';\r\n  IdApp: number = 0;\r\n  IdRole: number = 0;\r\n  i: number = 0;\r\n  listePermissionsPredefini: any[] = [];\r\n\r\n  constructor(private PermissionService: PermissionService, private RoleService: RoleService, private route: ActivatedRoute, private router: Router,\r\n    private ApplicationService: ApplicationService, private JournalisationService: JournalisationService, private ActionService: ActionService,\r\n    private UtilisateurService: UtilisateurService, private FonctionService: FonctionService ){}\r\n\r\n\r\n  ngOnInit(): void {\r\n    this.ajouterListePermissionsPredefini();\r\n    this.ApplicationService.getApplications().subscribe((data) => {\r\n      this.applications = data;\r\n      if (this.applications && this.applications.length > 0) {\r\n        this.IdApp = this.applications[0].id;\r\n        this.rechApp = this.applications[0].nom;\r\n        this.RoleService.getRoles(this.IdApp).subscribe((data) => {\r\n          this.roles = data;\r\n          this.IdRole = this.roles[0].id;\r\n          this.rechRole = this.roles[0].nom;\r\n          this.loadPermissions();\r\n        })\r\n      }\r\n    },\r\n      (error) => { console.error('Erreur lors de la récupération des applications : ', error); });\r\n  }\r\n\r\n\r\n  loadApplications(){\r\n    this.ApplicationService.getApplications().subscribe((data) => { this.applications = data; },\r\n      (error) => { console.error('Erreur lors de la récupération des applications : ', error); });\r\n  }\r\n\r\n\r\n  getSelectedApplicationId(): any {\r\n    const selectedApplication = this.applications.find((app) => app.nom === this.rechApp);\r\n    if (selectedApplication) {\r\n      this.IdApp = selectedApplication.id;\r\n      this.RoleService.getRoles(this.IdApp).subscribe((data) => {\r\n        this.roles = data;\r\n        this.IdRole = this.roles[0].id;\r\n        this.rechRole = this.roles[0].nom;\r\n        this.loadPermissions();\r\n      },\r\n        (error) => { console.error('Erreur lors de la récupération des roles : ', error); });\r\n      return selectedApplication.id;\r\n    } else return 0;\r\n  }\r\n\r\n  getSelectedRoleId(): any {\r\n    const selectedRole = this.roles.find((r) => r.nom === this.rechRole);\r\n    if (selectedRole) {\r\n      this.IdRole = selectedRole.id;\r\n      this.loadPermissions();\r\n      return selectedRole.id;\r\n    } else return 0;\r\n  }\r\n\r\n  loadPermissions() {\r\n    if (this.applications.length > 0 && this.roles.length > 0){\r\n      this.PermissionService.getListeMultiFonction(this.IdApp, this.IdRole).subscribe((data) => { this.multiPermissions = data; },\r\n        (error) => { console.error('Erreur lors de la récupération des Permissions : ', error); });\r\n      this.PermissionService.getListeFonctionUnique(this.IdApp, this.IdRole).subscribe((data) => { this.uniquePermissions = data; },\r\n        (error) => { console.error('Erreur lors de la récupération des Permissions : ', error); });\r\n    }\r\n  }\r\n\r\n\r\n  RechMultiFonction(){\r\n    if (this.rechFonctionMulti == \"\") this.loadPermissions();\r\n    else {\r\n      this.PermissionService.getListeMultiFonction(this.IdApp, this.IdRole).subscribe((data) => {\r\n        this.multiPermissions = data;\r\n        this.multiPermissions = this.multiPermissions.filter(perm => {\r\n          return perm.nom.toLowerCase().includes(this.rechFonctionMulti.toLowerCase());\r\n        });\r\n      });\r\n    }\r\n  }\r\n\r\n\r\n  RechFonctionUnique() {\r\n    if (this.rechFonctionUnique == \"\") this.loadPermissions();\r\n    else {\r\n      this.PermissionService.getListeFonctionUnique(this.IdApp, this.IdRole).subscribe((data) => {\r\n        this.uniquePermissions = data;\r\n        this.uniquePermissions = this.uniquePermissions.filter(perm => {\r\n          return perm.nom.toLowerCase().includes(this.rechFonctionUnique.toLowerCase());\r\n        });\r\n      });\r\n    }\r\n  }\r\n\r\n\r\n  onModifierAccesFonctionMulti(index: number, perm: Permission, event: Event): void {\r\n    this.i = index;\r\n    const target = event.target as HTMLElement;\r\n    const span = target.querySelector('span');\r\n    if (span?.textContent === '✔') { span.textContent = '✖'; target.style.backgroundColor = 'red'; }\r\n    else if (span?.textContent === '✖') { span.textContent = '✔'; target.style.backgroundColor = '#128d3a'; }\r\n    this.PermissionService.ModifierAcces(this.IdApp, this.i, perm).subscribe(() => {\r\n      this.loadPermissions();\r\n      this.EnregistrerAction(this.IdApp, this.IdRole, \"MultiFonction\" ,perm);\r\n    });\r\n  }\r\n\r\n\r\n  onModifierAccesFonctionUnique(perm: Permission, event: Event): void {\r\n    const target = event.target as HTMLElement;\r\n    const span = target.querySelector('span');\r\n    if (span?.textContent === '✔' && perm.status == \"1\") { span.textContent = '✖'; target.style.backgroundColor = 'red'; }\r\n    else if (span?.textContent === '✖' && perm.status == \"0\") { span.textContent = '✔'; target.style.backgroundColor = '#128d3a';  }\r\n    this.PermissionService.ModifierAcces(this.IdApp, this.i, perm).subscribe(() => {\r\n      this.loadPermissions();\r\n      this.EnregistrerAction(this.IdApp, this.IdRole, \"Fonction Unique\" ,perm);\r\n    });\r\n  }\r\n\r\n\r\n  onModifierClick(id: number) { this.router.navigate(['Permission/ModifierPermission', id]); }\r\n\r\n\r\n  EnregistrerActionSupp(id: number) {\r\n    let username = localStorage.getItem(\"username\");\r\n    this.UtilisateurService.Recherche(username).subscribe((data) => {\r\n      this.JournalisationService.getJournalisations(data[0].id).subscribe((dataJournalisations) => {\r\n        let idJournalisation = dataJournalisations[dataJournalisations.length - 1].id;\r\n        const action: Action = {\r\n          id: 0, application: \"www.wbauth.com\", date: new Date(), description: `l'utilisateur ${username} a supprimer la permission avec l'id '${id}' du role '${this.rechRole}' dans l'application '${this.rechApp}' avec l'id '${this.IdApp}'`,\r\n          idJournalisation: idJournalisation, journalisation: dataJournalisations[dataJournalisations.length - 1]\r\n        }\r\n        this.ActionService.EnregistrementActions(action).subscribe(() => { console.log(action); });\r\n      });\r\n    });\r\n  }\r\n\r\n\r\n  deletePermission(id: number) {\r\n    if (confirm('Voulez-vous vraiment supprimer ce Permission ?')) {\r\n      this.PermissionService.deletePermission(id).subscribe(() => {\r\n        this.loadPermissions();\r\n        this.EnregistrerActionSupp(id);\r\n      });\r\n    }\r\n  }\r\n\r\n\r\n  scrollToTable2() {  if (this.table2) {  this.table2.nativeElement.scrollIntoView({ behavior: 'smooth', block: 'start' }); }}\r\n  scrollToTable1() {  if (this.table1) { this.table1.nativeElement.scrollIntoView({ behavior: 'smooth', block: 'start' }); }}\r\n\r\n\r\n\r\n  EnregistrerAction(IdApp: number ,IdRole: number ,type: string ,perm: Permission){\r\n    let username = localStorage.getItem(\"username\");\r\n    this.UtilisateurService.Recherche(username).subscribe((data) => {\r\n      this.JournalisationService.getJournalisations(data[0].id).subscribe((dataJournalisations) => {\r\n        let idJournalisation = dataJournalisations[dataJournalisations.length - 1].id;\r\n        if (type === \"MultiFonction\"){\r\n          const action: Action = {\r\n            id: 0, application: \"www.wbauth.com\", date: new Date(),\r\n            description: `l'utilisateur ${username} a modifier la permission '${perm.nom}' du role avec l'id '${IdRole}' de l'application avec l'id '${IdApp}'  `,\r\n            idJournalisation: idJournalisation, journalisation: dataJournalisations[dataJournalisations.length - 1]\r\n          }\r\n          this.ActionService.EnregistrementActions(action).subscribe(() => { console.log(action); });\r\n        }\r\n        else if (type === \"Fonction Unique\"){\r\n          const action: Action = {\r\n            id: 0, application: \"www.wbauth.com\", date: new Date(),\r\n            description: `l'utilisateur ${username} a modifier la permission '${perm.nom}' du role avec l'id '${IdRole}' de l'application avec l'id '${IdApp}'  `,\r\n            idJournalisation: idJournalisation, journalisation: dataJournalisations[dataJournalisations.length - 1]\r\n          }\r\n          this.ActionService.EnregistrementActions(action).subscribe(() => { console.log(action); });\r\n        }\r\n      })\r\n    })\r\n  }\r\n\r\n\r\n  ajouterListePermissionsPredefini() {\r\n    this.ApplicationService.Recherche(\"www.wbauth.com\").subscribe((dataApp) => {\r\n      if (dataApp[0].url == \"www.wbauth.com\") {\r\n        this.RoleService.getRoles(dataApp[0].id).subscribe((dataRoles) => {\r\n          for (const role of dataRoles) {\r\n            if (role.nom == \"Utilisateur\" || role.nom == \"utilisateur\") {\r\n              this.listePermissionsPredefini = [];\r\n              this.listePermissionsPredefini.push(\r\n                new Permission(0, 'Gestion des applications', '100000', role.id, role, 0, null),\r\n                new Permission(0, 'Gestion des fonctions', '100000', role.id, role, 0, null),\r\n                new Permission(0, 'Gestion des roles', '100000', role.id, role, 0, null),\r\n                new Permission(0, 'Gestion des permissions', '100000', role.id, role, 0, null),\r\n                new Permission(0, 'Gestion des utilisateurs', '100000', role.id, role, 0, null),\r\n                new Permission(0, 'Consulter la liste des accès utilisateurs', '0', role.id, role, 0, null),\r\n                new Permission(0, 'Modifier la liste des accès d\\'un utilisateur', '0', role.id, role, 0, null),\r\n                new Permission(0, 'Consulter la journalisation d\\'un utilisateur', '0', role.id, role, 0, null),\r\n                new Permission(0, 'Modifier son compte utilisateur', '1', role.id, role, 0, null),\r\n              );\r\n              for (const perm of this.listePermissionsPredefini) {\r\n                if (perm.status.length > 2) {\r\n                  this.PermissionService.RechMultiFonction(perm.nom, dataApp[0].id, role.id).subscribe((dataPermission) => {\r\n                    console.log(dataPermission);\r\n                    if (dataPermission && dataPermission.length < 1) {\r\n                      this.FonctionService.Recherche(perm.nom, dataApp[0].id).subscribe((dataFonction) => {\r\n                        perm.idFonction = dataFonction[0].id;\r\n                        perm.Fonction = dataFonction[0];\r\n                        this.PermissionService.addPermission(perm).subscribe(() => { });\r\n                      });\r\n                    }\r\n                  });\r\n                }\r\n                else if (perm.status.length < 2) {\r\n                  this.PermissionService.RechFonctionUnique(perm.nom, dataApp[0].id, role.id).subscribe((dataPermission) => {\r\n                    if (dataPermission && dataPermission.length < 1) {\r\n                      this.FonctionService.Recherche(perm.nom, dataApp[0].id).subscribe((dataFonction) => {\r\n                        perm.idFonction = dataFonction[0].id;\r\n                        perm.Fonction = dataFonction[0];\r\n                        this.PermissionService.addPermission(perm).subscribe(() => { });\r\n                      });   \r\n                    }    \r\n                  });  \r\n                }   \r\n              }    \r\n            }\r\n\r\n            else if (role.nom == \"Administrateur\" || role.nom == \"administrateur\") {\r\n              this.listePermissionsPredefini.push(\r\n                new Permission(0, 'Gestion des applications', '100000', role.id, role, 0, null),\r\n                new Permission(0, 'Gestion des fonctions', '100011', role.id, role, 0, null),\r\n                new Permission(0, 'Gestion des roles', '100011', role.id, role, 0, null),\r\n                new Permission(0, 'Gestion des permissions', '100011', role.id, role, 0, null),\r\n                new Permission(0, 'Gestion des utilisateurs', '111111', role.id, role, 0, null),\r\n                new Permission(0, 'Consulter la liste des accès utilisateurs', '1', role.id, role, 0, null),\r\n                new Permission(0, 'Modifier la liste des accès d\\'un utilisateur', '1', role.id, role, 0, null),\r\n                new Permission(0, 'Consulter la journalisation d\\'un utilisateur', '1', role.id, role, 0, null),\r\n                new Permission(0, 'Modifier son compte utilisateur', '1', role.id, role, 0, null),\r\n              );\r\n              for (const perm of this.listePermissionsPredefini) {\r\n                if (perm.status.length > 2) {\r\n                  this.PermissionService.RechMultiFonction(perm.nom, dataApp[0].id, role.id).subscribe((dataPermission) => {\r\n                    console.log(dataPermission);\r\n                    if (dataPermission && dataPermission.length < 1) {\r\n                      this.FonctionService.Recherche(perm.nom, dataApp[0].id).subscribe((dataFonction) => {\r\n                        perm.idFonction = dataFonction[0].id;\r\n                        perm.Fonction = dataFonction[0];\r\n                        this.PermissionService.addPermission(perm).subscribe(() => { });\r\n                      });\r\n                    }\r\n                  });\r\n                }\r\n                else if (perm.status.length < 2) {\r\n                  this.PermissionService.RechFonctionUnique(perm.nom, dataApp[0].id, role.id).subscribe((dataPermission) => {\r\n                    if (dataPermission && dataPermission.length < 1) {\r\n                      this.FonctionService.Recherche(perm.nom, dataApp[0].id).subscribe((dataFonction) => {\r\n                        perm.idFonction = dataFonction[0].id;\r\n                        perm.Fonction = dataFonction[0];\r\n                        this.PermissionService.addPermission(perm).subscribe(() => { });\r\n                      });\r\n                    }\r\n                  });\r\n                }\r\n              }\r\n            }\r\n\r\n            else if (role.nom == \"Super-Administrateur\" || role.nom == \"Super-administrateur\" || role.nom == \"super-administrateur\"\r\n              || role.nom == \"Super Administrateur\" || role.nom == \"Super administrateur\" || role.nom == \"super administrateur\") {\r\n              this.listePermissionsPredefini.push(\r\n                new Permission(0, 'Gestion des applications', '111111', role.id, role, 0, null),\r\n                new Permission(0, 'Gestion des fonctions', '111111', role.id, role, 0, null),\r\n                new Permission(0, 'Gestion des roles', '111111', role.id, role, 0, null),\r\n                new Permission(0, 'Gestion des permissions', '111111', role.id, role, 0, null),\r\n                new Permission(0, 'Gestion des utilisateurs', '111111', role.id, role, 0, null),\r\n                new Permission(0, 'Consulter la liste des accès utilisateurs', '1', role.id, role, 0, null),\r\n                new Permission(0, 'Modifier la liste des accès d\\'un utilisateur', '1', role.id, role, 0, null),\r\n                new Permission(0, 'Consulter la journalisation d\\'un utilisateur', '1', role.id, role, 0, null),\r\n                new Permission(0, 'Modifier son compte utilisateur', '1', role.id, role, 0, null),\r\n              );\r\n              for (const perm of this.listePermissionsPredefini) {\r\n                if (perm.status.length > 2) {\r\n                  this.PermissionService.RechMultiFonction(perm.nom, dataApp[0].id, role.id).subscribe((dataPermission) => {\r\n                    console.log(dataPermission);\r\n                    if (dataPermission && dataPermission.length < 1) {\r\n                      this.FonctionService.Recherche(perm.nom, dataApp[0].id).subscribe((dataFonction) => {\r\n                        perm.idFonction = dataFonction[0].id;\r\n                        perm.Fonction = dataFonction[0];\r\n                        this.PermissionService.addPermission(perm).subscribe(() => { });\r\n                      });\r\n                    }\r\n                  });\r\n                }\r\n                else if (perm.status.length < 2) {\r\n                  this.PermissionService.RechFonctionUnique(perm.nom, dataApp[0].id, role.id).subscribe((dataPermission) => {\r\n                    if (dataPermission && dataPermission.length < 1) {\r\n                      this.FonctionService.Recherche(perm.nom, dataApp[0].id).subscribe((dataFonction) => {\r\n                        perm.idFonction = dataFonction[0].id;\r\n                        perm.Fonction = dataFonction[0];\r\n                        this.PermissionService.addPermission(perm).subscribe(() => { });\r\n                      });\r\n                    }\r\n                  });\r\n                }\r\n              }\r\n            }\r\n\r\n          }   \r\n        });  \r\n      }    \r\n    });  \r\n  }\r\n\r\n\r\n\r\n\r\n\r\n\r\n}\r\n","      <div class=\"background-titre\"> <h1> GESTION DES PERMISSIONS </h1> </div>\r\n      <div class=\"centered-element\">\r\n        <div class=\"content\">\r\n\r\n          <div class=\"search-bar-and-add\">\r\n            <button class=\"add-button\" [routerLink]=\"['/Permission/AjouterPermission']\">\r\n              <i class=\"fas fa-plus\" style=\"color: #1ddd92;\"></i>  &nbsp;  AJOUTER\r\n            </button>\r\n            <input [(ngModel)]=\"rechFonctionMulti\" (input)=\"RechMultiFonction()\" class=\"search-input\" type=\"text\" placeholder=\"Rechercher...\">\r\n            <button class=\"search-button\" type=\"submit\"><i class=\"fas fa-search\"></i></button>\r\n          </div>\r\n          <br />\r\n\r\n          <div class=\"choix-application\">\r\n            <label style=\"transform:translateX(-3px)\" for=\"nom\">APPLICATION :</label>\r\n            <select id=\"IdApp\" name=\"IdApp\" [(ngModel)]=\"rechApp\" (ngModelChange)=\"getSelectedApplicationId()\">\r\n              <option *ngFor=\"let app of applications\" [value]=\"app.nom\">{{ app.nom }}</option>\r\n            </select>\r\n\r\n            <label style=\"transform:translateX(-3px)\" for=\"nom\">RÔLE :</label>\r\n            <select id=\"IdRole\" name=\"IdRole\" [(ngModel)]=\"rechRole\" (ngModelChange)=\"getSelectedRoleId()\">\r\n              <option *ngFor=\"let role of roles\" [value]=\"role.nom\">{{ role.nom }} ( Niveau {{ role.niveau }} )</option>\r\n            </select>\r\n          </div>\r\n\r\n\r\n          <div style=\"white-space:nowrap ; border: 1.5px solid #349AB5; border-radius:4px; padding:4px; font-weight:600;\r\n                 display:flex; align-items:center \">\r\n            <button (click)=\"scrollToTable2()\" class=\"add-button\" style=\"padding:8.5px;\"> <i class=\"fa-solid fa-angles-down\" style=\"color:gold;\"></i> </button>\r\n            <div style=\"margin:auto;\"> TABLEAU MULTI-FONCTIONS </div>\r\n          </div>\r\n          <br />\r\n\r\n\r\n          <table aria-labelledby=\"tableLabel\" *ngIf=\"multiPermissions\" #table1>\r\n            <thead>\r\n              <tr>\r\n                <th></th>\r\n                <th>LECTURE</th>\r\n                <th>AJOUT</th>\r\n                <th>MODIFICATION</th>\r\n                <th>SUPRESSION</th>\r\n                <th>IMPRESSION</th>\r\n                <th>EXPORTATION</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              <tr *ngFor=\"let permission of multiPermissions\">\r\n                <td> <i (click)=\"onModifierClick(permission.id)\" [routerLink]=\"['/Permission/ModifierPermission']\" class=\"far fa-edit\" style=\"color: #e6c347;\"></i>\r\n                     <i (click)=\"deletePermission(permission.id)\" class=\"far fa-trash-alt\" style=\"color:red; margin:0px 7px 0px 7px;\"></i> {{ permission.nom }} </td>\r\n\r\n                <td (click)=\"onModifierAccesFonctionMulti(0,permission ,$event)\" style=\"display:flex; justify-content:center; cursor:pointer;\">\r\n                  <span class=\"no-select\" appCellStyle=\"{{ permission.status[0] === '0' ? '✖' : '✔' }}\">{{ permission.status[0] === '0' ? '✖' : '✔' }}</span>\r\n                </td>\r\n\r\n                <td (click)=\"onModifierAccesFonctionMulti(1,permission ,$event)\" style=\"position:relative; cursor:pointer;\">\r\n                  <span class=\"no-select\" appCellStyle=\"{{ permission.status[1] === '0' ? '✖' : '✔' }}\"\r\n                        style=\"position:relative; left:45%;\">{{ permission.status[1] === '0' ? '✖' : '✔' }}</span>\r\n                </td>\r\n\r\n                <td (click)=\"onModifierAccesFonctionMulti(2,permission ,$event)\" style=\"display:flex; justify-content:center; cursor:pointer;\">\r\n                  <span class=\"no-select\" appCellStyle=\"{{ permission.status[2] === '0' ? '✖' : '✔' }}\">{{ permission.status[2] === '0' ? '✖' : '✔' }}</span>\r\n                </td>\r\n\r\n                <td (click)=\"onModifierAccesFonctionMulti(3,permission ,$event)\" style=\"position:relative; cursor:pointer;\">\r\n                  <span class=\"no-select\" appCellStyle=\"{{ permission.status[3] === '0' ? '✖' : '✔' }}\"\r\n                        style=\"position: relative; left: 45%;\">{{ permission.status[3] === '0' ? '✖' : '✔' }}</span>\r\n                </td>\r\n\r\n                <td (click)=\"onModifierAccesFonctionMulti(4,permission ,$event)\" style=\"display:flex; justify-content:center; cursor:pointer;\">\r\n                  <span class=\"no-select\" appCellStyle=\"{{ permission.status[4] === '0' ? '✖' : '✔' }}\">{{ permission.status[4] === '0' ? '✖' : '✔' }}</span>\r\n                </td>\r\n\r\n                <td (click)=\"onModifierAccesFonctionMulti(5,permission ,$event)\" style=\"position:relative; cursor:pointer;\">\r\n                  <span class=\"no-select\" appCellStyle=\"{{ permission.status[5] === '0' ? '✖' : '✔' }}\"\r\n                        style=\"position: relative; left: 45%;\">{{ permission.status[5] === '0' ? '✖' : '✔' }}</span>\r\n                </td>\r\n\r\n              </tr>\r\n            </tbody>\r\n\r\n\r\n          </table>\r\n          <br /><br /><br /><br />\r\n\r\n\r\n<!--------------------------------------------------------------------------------------------------------------------------------------------------------->\r\n          <hr style=\"color:aqua;\"/>\r\n          <div class=\"search-bar-and-add\">\r\n            <button class=\"add-button\" [routerLink]=\"['/Permission/AjouterPermission']\">\r\n              <i class=\"fas fa-plus\" style=\"color: #1ddd92;\"></i>  &nbsp;  AJOUTER\r\n            </button>\r\n            <input [(ngModel)]=\"rechFonctionUnique\" (input)=\"RechFonctionUnique()\" class=\"search-input\" type=\"text\" placeholder=\"Rechercher...\">\r\n            <button class=\"search-button\" type=\"submit\"><i class=\"fas fa-search\"></i></button>\r\n          </div>\r\n          <br />\r\n\r\n          <div style=\"white-space:nowrap ; border: 1.5px solid #349AB5; border-radius:4px; padding:4px; font-weight:600;\r\n                 display:flex; align-items:center \">\r\n            <button (click)=\"scrollToTable1()\" class=\"add-button\" style=\"padding:8.5px;\"> <i class=\"fa-solid fa-angles-up\" style=\"color:gold;\"></i> </button>\r\n            <div style=\"margin:auto;\"> TABLEAU DE FONCTION UNIQUE </div>\r\n          </div>\r\n          <br />\r\n\r\n\r\n          <table aria-labelledby=\"tableLabel\" *ngIf=\"uniquePermissions\" #table2>\r\n            <thead>\r\n              <tr>\r\n                <th></th>\r\n                <th>ACTION</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              <tr *ngFor=\"let permission of uniquePermissions\">\r\n                <td>  <i (click)=\"onModifierClick(permission.id)\" [routerLink]=\"['/Permission/ModifierPermission']\" class=\"far fa-edit\" style=\"color: #e6c347;\"></i>\r\n                      <i (click)=\"deletePermission(permission.id)\" class=\"far fa-trash-alt\" style=\"color:red; margin:0px 7px 0px 7px;\"></i> {{ permission.nom }} </td>\r\n                <td (click)=\"onModifierAccesFonctionUnique(permission ,$event)\" style=\"position:relative; cursor:pointer;\">\r\n                  <span class=\"no-select\" appCellStyle=\"{{ permission.status === '0' ? '✖' : '✔' }}\"\r\n                        style=\"position: relative; left: 45%;\">{{ permission.status === '0' ? '✖' : '✔' }}</span>\r\n                </td>\r\n              </tr>\r\n            </tbody>\r\n\r\n\r\n\r\n          </table>\r\n        </div>\r\n      </div>\r\n\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}