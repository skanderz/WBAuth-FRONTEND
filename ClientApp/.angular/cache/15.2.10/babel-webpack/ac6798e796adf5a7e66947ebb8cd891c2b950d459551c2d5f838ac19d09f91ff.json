{"ast":null,"code":"import { Application } from '../../../Models/application.model';\nimport { UtilisateurApplication } from '../../../Models/utilisateurapplication.model';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../../Services/utilisateurapplication.service\";\nimport * as i2 from \"../../../Services/application.service\";\nimport * as i3 from \"../../../Services/role.service\";\nimport * as i4 from \"../../../Services/utilisateur.service\";\nimport * as i5 from \"@angular/router\";\nimport * as i6 from \"@angular/common\";\nimport * as i7 from \"@angular/forms\";\nfunction AccesComponent_option_27_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 20);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const app_r2 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", app_r2.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(app_r2.nom);\n  }\n}\nconst _c0 = function () {\n  return [\"/Utilisateur/ModifierAcces\"];\n};\nfunction AccesComponent_table_28_tr_13_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\")(2, \"div\", 23)(3, \"i\", 24);\n    i0.ɵɵlistener(\"click\", function AccesComponent_table_28_tr_13_Template_i_click_3_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r6);\n      const t_r4 = restoredCtx.$implicit;\n      const ctx_r5 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r5.onModifierClick(t_r4.guid));\n    });\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(4, \"td\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"td\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"td\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"td\");\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const t_r4 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(5, _c0));\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", t_r4.guid, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", t_r4.userName, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", t_r4.status, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(t_r4.role);\n  }\n}\nfunction AccesComponent_table_28_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"table\", 21)(1, \"thead\")(2, \"tr\");\n    i0.ɵɵelement(3, \"th\");\n    i0.ɵɵelementStart(4, \"th\");\n    i0.ɵɵtext(5, \"GUID \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"th\");\n    i0.ɵɵtext(7, \"UTILISATEUR\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"th\");\n    i0.ɵɵtext(9, \"STATUS\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"th\");\n    i0.ɵɵtext(11, \"ROLE\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(12, \"tbody\");\n    i0.ɵɵtemplate(13, AccesComponent_table_28_tr_13_Template, 12, 6, \"tr\", 22);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(13);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.accesTable);\n  }\n}\nconst _c1 = function () {\n  return [\"/Utilisateur\"];\n};\nconst _c2 = function () {\n  return [\"user-button-active\"];\n};\nconst _c3 = function () {\n  return {\n    exact: true\n  };\n};\nconst _c4 = function () {\n  return [\"/Utilisateur/Acces\"];\n};\nconst _c5 = function () {\n  return [\"/Utilisateur/Activite\"];\n};\nconst _c6 = function () {\n  return [\"/Utilisateur/AjouterUtilisateur\"];\n};\nexport class AccesComponent {\n  constructor(UAService, ApplicationService, RoleService, UtilisateurService, router, route) {\n    this.UAService = UAService;\n    this.ApplicationService = ApplicationService;\n    this.RoleService = RoleService;\n    this.UtilisateurService = UtilisateurService;\n    this.router = router;\n    this.route = route;\n    this.Utilisateurs = [];\n    this.IdApp = 0;\n    this.applications = [];\n    this.UtilisateurApp = new UtilisateurApplication();\n    this.UtilisateurApps = [];\n    this.application = new Application();\n    this.accesTable = [];\n    this.rechTable = [];\n    this.userAppList = [];\n    this.utilisateurs = [];\n    this.roles = [];\n    this.rech = \"\";\n  }\n  ngOnInit() {\n    this.ApplicationService.getApplications().subscribe(data => {\n      this.applications = data;\n      if (this.applications && this.applications.length > 0) {\n        this.IdApp = this.applications[0].id;\n        this.loadUtilisateurs();\n        this.loadUtilisateursByIdApp(this.IdApp);\n      }\n    }, error => {\n      console.error('Erreur lors de la récupération des applications : ', error);\n    });\n  }\n  loadUtilisateurs() {\n    this.UtilisateurService.getUtilisateurs().subscribe(data => {\n      this.Utilisateurs = data; // userlist\n      console.log(this.Utilisateurs);\n      for (const user of this.Utilisateurs) {\n        // chaque user\n        this.UAService.getListByUtilisateur(user.id).subscribe(UAdata => {\n          this.ApplicationService.getApplications().subscribe(AppData => {\n            this.applications = AppData; // App list \n            for (const app of this.applications) {\n              this.UtilisateurApps = UAdata; // userApp list\n              const result = this.UtilisateurApps.filter(ua => ua.guidUtilisateur == user.id && ua.idApplication == app.id);\n              if (result.length == 0) {\n                this.UtilisateurApp.idRole = null;\n                this.UtilisateurApp.idApplication = app.id;\n                this.UtilisateurApp.guidUtilisateur = user.id;\n                console.log(this.UtilisateurApp);\n                this.UAService.AddUtilisateurApplication(this.UtilisateurApp).subscribe(response => {\n                  if (response) {\n                    console.log(this.UtilisateurApp);\n                  }\n                });\n              }\n            }\n          });\n        });\n      }\n    }, error => {\n      console.error('Erreur lors de la récupération des Utilisateur : ', error);\n    });\n  }\n  loadUtilisateursByIdApp(id) {\n    this.accesTable = [];\n    this.UAService.getListByApplication(id).subscribe(UAdata => {\n      this.userAppList = UAdata;\n      for (const ua of this.userAppList) {\n        this.UtilisateurService.getUtilisateur(ua.guidUtilisateur).subscribe(UserData => {\n          if (ua.idRole == null) {\n            this.accesTable.push({\n              guid: UserData.id,\n              userName: UserData.userName,\n              status: ua.acces,\n              role: \"non effectuée\"\n            });\n          } else {\n            this.RoleService.getRole(ua.idRole).subscribe(RoleData => {\n              this.accesTable.push({\n                guid: UserData.id,\n                userName: UserData.userName,\n                status: ua.acces,\n                role: RoleData.nom\n              });\n            });\n          }\n          ;\n        });\n      }\n    });\n  }\n  Recherche() {\n    if (this.rech == \"\") {\n      this.loadUtilisateursByIdApp(this.IdApp);\n    } else {\n      this.rechTable = this.accesTable.filter(item => {\n        return item.userName.includes(this.rech);\n      });\n      console.log(this.rechTable);\n      this.accesTable = [];\n      this.accesTable = this.accesTable.concat(this.rechTable);\n      this.rechTable = [];\n    }\n  }\n  onModifierClick(id) {\n    this.router.navigate(['Utilisateur/ModifierAcces', id]);\n  }\n  static #_ = this.ɵfac = function AccesComponent_Factory(t) {\n    return new (t || AccesComponent)(i0.ɵɵdirectiveInject(i1.UtilisateurApplicationService), i0.ɵɵdirectiveInject(i2.ApplicationService), i0.ɵɵdirectiveInject(i3.RoleService), i0.ɵɵdirectiveInject(i4.UtilisateurService), i0.ɵɵdirectiveInject(i5.Router), i0.ɵɵdirectiveInject(i5.ActivatedRoute));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AccesComponent,\n    selectors: [[\"app-Acces\"]],\n    decls: 29,\n    vars: 20,\n    consts: [[1, \"background-titre\"], [1, \"centered-element\"], [1, \"content\"], [2, \"display\", \"flex\", \"justify-content\", \"center\"], [\"id\", \"user-button\", 1, \"user-button\", 3, \"routerLink\", \"routerLinkActive\", \"routerLinkActiveOptions\"], [1, \"fa-solid\", \"fa-list\"], [\"id\", \"user-button\", 1, \"user-button\", 3, \"routerLink\", \"routerLinkActive\"], [1, \"fa-solid\", \"fa-user-lock\"], [1, \"fa-solid\", \"fa-clock-rotate-left\"], [1, \"search-bar-and-add\"], [1, \"add-button\", 3, \"routerLink\"], [1, \"fas\", \"fa-plus\", 2, \"color\", \"#1ddd92\"], [\"type\", \"text\", \"placeholder\", \"Rechercher...\", 1, \"search-input\", 3, \"ngModel\", \"ngModelChange\", \"input\"], [\"type\", \"submit\", 1, \"search-button\"], [1, \"fas\", \"fa-search\"], [1, \"choix-application\"], [\"for\", \"nom\"], [\"id\", \"choix\", \"name\", \"choix\", 3, \"ngModel\", \"ngModelChange\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"aria-labelledby\", \"tableLabel\", 4, \"ngIf\"], [3, \"value\"], [\"aria-labelledby\", \"tableLabel\"], [4, \"ngFor\", \"ngForOf\"], [2, \"display\", \"flex\", \"justify-content\", \"center\", \"align-items\", \"center\"], [1, \"far\", \"fa-edit\", 2, \"color\", \"#e6c347\", 3, \"routerLink\", \"click\"]],\n    template: function AccesComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"h1\");\n        i0.ɵɵtext(2, \" GESTION DES UTILISATEURS \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(3, \"div\", 1)(4, \"div\", 2)(5, \"div\", 3)(6, \"button\", 4);\n        i0.ɵɵelement(7, \"i\", 5);\n        i0.ɵɵtext(8, \" \\u00A0 LISTE \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(9, \"button\", 6);\n        i0.ɵɵelement(10, \"i\", 7);\n        i0.ɵɵtext(11, \" \\u00A0 ACC\\u00C8S \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"button\", 6);\n        i0.ɵɵelement(13, \"i\", 8);\n        i0.ɵɵtext(14, \" \\u00A0 ACTIVIT\\u00C9 \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(15, \"div\", 9)(16, \"button\", 10);\n        i0.ɵɵelement(17, \"i\", 11);\n        i0.ɵɵtext(18, \" \\u00A0 AJOUTER \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(19, \"input\", 12);\n        i0.ɵɵlistener(\"ngModelChange\", function AccesComponent_Template_input_ngModelChange_19_listener($event) {\n          return ctx.rech = $event;\n        })(\"input\", function AccesComponent_Template_input_input_19_listener() {\n          return ctx.Recherche();\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(20, \"button\", 13);\n        i0.ɵɵelement(21, \"i\", 14);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(22, \"br\");\n        i0.ɵɵelementStart(23, \"div\", 15)(24, \"label\", 16);\n        i0.ɵɵtext(25, \"APPLICATION :\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(26, \"select\", 17);\n        i0.ɵɵlistener(\"ngModelChange\", function AccesComponent_Template_select_ngModelChange_26_listener($event) {\n          return ctx.IdApp = $event;\n        })(\"ngModelChange\", function AccesComponent_Template_select_ngModelChange_26_listener() {\n          return ctx.loadUtilisateursByIdApp(ctx.IdApp);\n        });\n        i0.ɵɵtemplate(27, AccesComponent_option_27_Template, 2, 2, \"option\", 18);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(28, AccesComponent_table_28_Template, 14, 1, \"table\", 19);\n        i0.ɵɵelementEnd()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(12, _c1))(\"routerLinkActive\", i0.ɵɵpureFunction0(13, _c2))(\"routerLinkActiveOptions\", i0.ɵɵpureFunction0(14, _c3));\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(15, _c4))(\"routerLinkActive\", i0.ɵɵpureFunction0(16, _c2));\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(17, _c5))(\"routerLinkActive\", i0.ɵɵpureFunction0(18, _c2));\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(19, _c6));\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngModel\", ctx.rech);\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"ngModel\", ctx.IdApp);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.applications);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.userAppList);\n      }\n    },\n    dependencies: [i6.NgForOf, i6.NgIf, i7.NgSelectOption, i7.ɵNgSelectMultipleOption, i7.DefaultValueAccessor, i7.SelectControlValueAccessor, i7.NgControlStatus, i7.NgModel, i5.RouterLink, i5.RouterLinkActive],\n    encapsulation: 2\n  });\n}","map":{"version":3,"mappings":"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","names":["Application","UtilisateurApplication","i0","AccesComponent","constructor","UAService","ApplicationService","RoleService","UtilisateurService","router","route","ngOnInit","getApplications","subscribe","data","applications","length","IdApp","id","loadUtilisateurs","loadUtilisateursByIdApp","error","console","getUtilisateurs","Utilisateurs","log","user","getListByUtilisateur","UAdata","AppData","app","UtilisateurApps","result","filter","ua","guidUtilisateur","idApplication","UtilisateurApp","idRole","AddUtilisateurApplication","response","accesTable","getListByApplication","userAppList","getUtilisateur","UserData","push","guid","userName","status","acces","role","getRole","RoleData","nom","Recherche","rech","rechTable","item","includes","concat","onModifierClick","navigate","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["C:\\Users\\Skander\\source\\repos\\WBAuth.Frontend\\ClientApp\\src\\app\\Modules\\Utilisateur\\Acces\\Acces.component.ts","C:\\Users\\Skander\\source\\repos\\WBAuth.Frontend\\ClientApp\\src\\app\\Modules\\Utilisateur\\Acces\\Acces.component.html"],"sourcesContent":["import { Component, Inject, OnInit } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Utilisateur } from '../../../Models/utilisateur.model';\r\nimport { Role } from '../../../Models/role.model';\r\nimport { Application } from '../../../Models/application.model';\r\nimport { filter, Observable } from 'rxjs';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { UtilisateurService } from '../../../Services/utilisateur.service';\r\nimport { RoleService } from '../../../Services/role.service';\r\nimport { ApplicationService } from '../../../Services/application.service';\r\nimport { UtilisateurApplicationService } from '../../../Services/utilisateurapplication.service';\r\nimport { UtilisateurApplication } from '../../../Models/utilisateurapplication.model';\r\n\r\n\r\n\r\n@Component({\r\n  selector: 'app-Acces',\r\n  templateUrl: './Acces.component.html'\r\n})\r\nexport class AccesComponent implements OnInit {\r\n  Utilisateurs: any[] = [];\r\n  IdApp: number = 0;\r\n  applications: any[] = [];\r\n  UtilisateurApp: UtilisateurApplication = new UtilisateurApplication();\r\n  UtilisateurApps: UtilisateurApplication[] = [];\r\n  application: Application = new Application();\r\n  accesTable: { guid: string, userName: string, status: boolean, role: string }[] = [];\r\n  rechTable: { guid: string ,userName: string, status: boolean, role: string }[] = [];\r\n  userAppList: any[] = [];\r\n  utilisateurs: any[] = [];\r\n  roles: any[] = [];\r\n  rech: string = \"\";\r\n\r\n\r\n  constructor(private UAService: UtilisateurApplicationService, private ApplicationService: ApplicationService,\r\n    private RoleService: RoleService, private UtilisateurService: UtilisateurService, private router: Router, private route: ActivatedRoute){}\r\n\r\n\r\n  ngOnInit(): void {\r\n    this.ApplicationService.getApplications().subscribe((data) => {\r\n      this.applications = data\r\n      if (this.applications && this.applications.length > 0) {\r\n        this.IdApp = this.applications[0].id;\r\n        this.loadUtilisateurs();\r\n        this.loadUtilisateursByIdApp(this.IdApp);\r\n      }\r\n    },\r\n      (error) => { console.error('Erreur lors de la récupération des applications : ', error); });\r\n  }\r\n\r\n  loadUtilisateurs() {\r\n    this.UtilisateurService.getUtilisateurs().subscribe((data) => {\r\n      this.Utilisateurs = data; // userlist\r\n      console.log(this.Utilisateurs);\r\n      for (const user of this.Utilisateurs) { // chaque user\r\n        this.UAService.getListByUtilisateur(user.id).subscribe((UAdata) => {\r\n          this.ApplicationService.getApplications().subscribe((AppData) => {\r\n            this.applications = AppData; // App list \r\n            for (const app of this.applications) {\r\n              this.UtilisateurApps = UAdata;  // userApp list\r\n              const result = this.UtilisateurApps.filter((ua) => (ua.guidUtilisateur == user.id) && (ua.idApplication == app.id));\r\n              if (result.length == 0) {\r\n                this.UtilisateurApp.idRole = null;\r\n                this.UtilisateurApp.idApplication = app.id;\r\n                this.UtilisateurApp.guidUtilisateur = user.id;\r\n                console.log(this.UtilisateurApp);\r\n                this.UAService.AddUtilisateurApplication(this.UtilisateurApp).subscribe((response) => {\r\n                  if (response) { console.log(this.UtilisateurApp); }\r\n                });\r\n              }\r\n            }\r\n          });\r\n        });\r\n      }\r\n    }, (error) => { console.error('Erreur lors de la récupération des Utilisateur : ', error); });\r\n  }\r\n\r\n  loadUtilisateursByIdApp(id: number) {\r\n    this.accesTable = [];\r\n    this.UAService.getListByApplication(id).subscribe((UAdata) => {\r\n      this.userAppList = UAdata;\r\n      for (const ua of this.userAppList) {\r\n        this.UtilisateurService.getUtilisateur(ua.guidUtilisateur).subscribe((UserData) => {\r\n          if (ua.idRole == null) {\r\n            this.accesTable.push({ guid: UserData.id, userName: UserData.userName, status: ua.acces, role: \"non effectuée\" });\r\n          }\r\n          else {\r\n            this.RoleService.getRole(ua.idRole).subscribe((RoleData) => {\r\n              this.accesTable.push({ guid: UserData.id, userName: UserData.userName, status: ua.acces, role: RoleData.nom  });\r\n            })\r\n          };\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n\r\n  Recherche() {\r\n    if (this.rech == \"\") {\r\n      this.loadUtilisateursByIdApp(this.IdApp);\r\n    }\r\n    else {\r\n      this.rechTable = this.accesTable.filter(item => { return item.userName.includes(this.rech); });\r\n      console.log(this.rechTable);\r\n      this.accesTable = [];\r\n      this.accesTable = this.accesTable.concat(this.rechTable);\r\n      this.rechTable = [];\r\n    }     \r\n  }\r\n\r\n\r\n  onModifierClick(id: string) { this.router.navigate(['Utilisateur/ModifierAcces', id]); }\r\n\r\n\r\n\r\n\r\n}\r\n\r\n","<div class=\"background-titre\"> <h1> GESTION DES UTILISATEURS </h1> </div>\r\n<div class=\"centered-element\">\r\n  <div class=\"content\">\r\n\r\n    <div style=\"display:flex; justify-content:center;\">\r\n      <button class=\"user-button\" id=\"user-button\" [routerLink]=\"['/Utilisateur']\" [routerLinkActive]=\"['user-button-active']\" [routerLinkActiveOptions]=\"{ exact: true }\">\r\n        <i class=\"fa-solid fa-list\"></i>  &nbsp; LISTE\r\n      </button>\r\n      <button class=\"user-button\" id=\"user-button\" [routerLink]=\"['/Utilisateur/Acces']\" [routerLinkActive]=\"['user-button-active']\">\r\n        <i class=\"fa-solid fa-user-lock\"></i> &nbsp; ACCÈS\r\n      </button>\r\n      <button class=\"user-button\" id=\"user-button\" [routerLink]=\"['/Utilisateur/Activite']\" [routerLinkActive]=\"['user-button-active']\">\r\n        <i class=\"fa-solid fa-clock-rotate-left\"></i>  &nbsp; ACTIVITÉ\r\n      </button>\r\n    </div>\r\n\r\n\r\n    <div class=\"search-bar-and-add\">\r\n      <button class=\"add-button\" [routerLink]=\"['/Utilisateur/AjouterUtilisateur']\">\r\n        <i class=\"fas fa-plus\" style=\"color: #1ddd92;\"></i>  &nbsp;  AJOUTER\r\n      </button>\r\n      <input [(ngModel)]=\"rech\" (input)=\"Recherche()\" class=\"search-input\" type=\"text\" placeholder=\"Rechercher...\">\r\n      <button class=\"search-button\" type=\"submit\"><i class=\"fas fa-search\"></i></button>\r\n    </div>\r\n    <br />\r\n\r\n    <div class=\"choix-application\">\r\n      <label for=\"nom\">APPLICATION :</label>\r\n      <select id=\"choix\" name=\"choix\" [(ngModel)]=\"IdApp\" (ngModelChange)=\"loadUtilisateursByIdApp(IdApp)\">\r\n        <option *ngFor=\"let app of applications\" [value]=\"app.id\">{{ app.nom }}</option>\r\n      </select>\r\n    </div>\r\n\r\n    <table aria-labelledby=\"tableLabel\" *ngIf=\"userAppList\">\r\n      <thead>\r\n        <tr>\r\n          <th></th>\r\n          <th>GUID </th>\r\n          <th>UTILISATEUR</th>\r\n          <th>STATUS</th>\r\n          <th>ROLE</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr *ngFor=\"let t of accesTable\">\r\n          <td>\r\n           <div style=\"display:flex; justify-content:center; align-items:center;\">\r\n           <i (click)=\"onModifierClick(t.guid)\" [routerLink]=\"['/Utilisateur/ModifierAcces']\" class=\"far fa-edit\" style=\"color: #e6c347;\"></i>\r\n           </div>\r\n          </td>\r\n          <td>{{ t.guid }} </td>\r\n          <td>\r\n              {{ t.userName }} \r\n          </td>\r\n          <td>{{ t.status }} </td>\r\n          <td>{{ t.role }}</td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n\r\n  </div>\r\n</div>\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}